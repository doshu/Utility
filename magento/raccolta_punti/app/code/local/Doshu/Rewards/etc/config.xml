<?xml version="1.0"?>
<config>
	<modules>
		<Doshu_Rewards>
			<version>0.1.1</version>
		</Doshu_Rewards>
	</modules>
	<global>
		<helpers>
			<rewards>
				<class>Doshu_Rewards_Helper</class>
			</rewards>
		</helpers>
		<models>
			<rewards>
				<class>Doshu_Rewards_Model</class>
			</rewards>
		</models>
		<blocks>
			<rewards>
				<class>Doshu_Rewards_Block</class>
			</rewards>
		</blocks>
		<resources>
			<rewards_setup>
				<setup>
					<module>Doshu_Rewards</module>
					<class>Doshu_Rewards_Model_Resource_Setup</class>
				</setup>
				<connection>
					<use>core_setup</use>
				</connection>
			</rewards_setup>
			<rewards_write>
				<use>core_write</use>
			</rewards_write>
			<rewards_read>
				<use>core_read</use>
			</rewards_read>
		</resources>
	</global>
	<frontend>
		<routers>
			<rewards>
				<use>standard</use>
				<args>
					<module>Doshu_Rewards</module>
					<frontName>rewards</frontName>
				</args>
			</rewards>
		</routers>
		<layout>
			<updates>
			    <rewards>
			        <file>rewards.xml</file>
			    </rewards>
			</updates>
		</layout>
		<events> 
			<sales_quote_collect_totals_after>
				<observers>
					<set_rewards_discount>
						<type>singleton</type>
						<class>rewards/observer</class>
						<method>setRewardsDiscount</method>
					</set_rewards_discount>
				</observers>
			</sales_quote_collect_totals_after>  
	   		<sales_order_place_after>
		        <observers>
		            <use_customer_points>
		                <type>singleton</type>
		                <class>rewards/observer</class>
		                <method>useCustomerPoints</method>
		            </use_customer_points>
		        </observers>
		    </sales_order_place_after>
		    <sales_order_invoice_save_after>
		        <observers>
		            <add_customer_points>
		                <type>singleton</type>
		                <class>rewards/observer</class>
		                <method>addCustomerPoints</method>
		            </add_customer_points>
		        </observers>
		    </sales_order_invoice_save_after>
		</events>   
	</frontend>    
	<adminhtml>
		<events>
			<sales_order_invoice_save_after>
		        <observers>
		            <admin_add_customer_points>
		                <type>singleton</type>
		                <class>rewards/observer</class>
		                <method>adminAddCustomerPoints</method>
		            </admin_add_customer_points>
		        </observers>
		    </sales_order_invoice_save_after>
		</events>
        <layout>
            <updates>
                <rewards>
                    <file>rewards.xml</file>
                </rewards>
            </updates>
        </layout>
        <args>
            <modules>
                <Doshu_Rewards before="Mage_Adminhtml">Doshu_Rewards</Doshu_Rewards>
            </modules>
        </args>
    </adminhtml>
</config> 
